<div class="oj-flex oj-sm-padding-4x" id="cardsPage">
  <div class="oj-flex-item">
    <h2 class="oj-typography-heading-lg oj-text-color-primary">Card Details</h2>

    <!-- Cards Table -->
    <oj-table
      id="cardsTable"
      aria-label="Cards Table"
      data="[[dataProvider]]"
      columns='[
        {"headerText": "Card ID", "field": "cardId"},
        {"headerText": "Account No", "field": "accountNo"},
        {"headerText": "Card Number", "field": "cardNumber"},
        {"headerText": "Card Type", "field": "cardType"},
        {"headerText": "Expiry Date", "field": "expiryDate"},
        {"headerText": "Status", "field": "status"},
        {"headerText": "Actions", "template": "actionTemplate"}
      ]'
      display="grid"
      class="oj-sm-margin-4x-top"
      style="width:100%; max-width:1100px; margin:auto;">

      <template slot="actionTemplate" data-oj-as="cell">
        <div style="display: flex; gap: 10px;">
          <a href="#" style="color: #dc3545; text-decoration: none;" data-bind="click: function() { deleteCard(cell.row); }">Delete</a>
        </div>
      </template>
    </oj-table>

    <!-- Buttons -->
    <div class="oj-sm-margin-2x-top oj-flex oj-sm-justify-content-start">
      <oj-button on-oj-action="[[openCreateDialog]]" class="oj-button-primary">
        Create Card
      </oj-button>
      <oj-button on-oj-action="[[fetchCards]]" class="oj-sm-margin-start-2x">
        Refresh
      </oj-button>
    </div>

    <!-- Status Message -->
    <div data-bind="text: statusMessage" class="oj-sm-margin-2x-top oj-text-color-secondary"></div>
  </div>

  <!-- Create Card Dialog -->
  <oj-dialog id="createCardDialog" dialog-title="Create New Card" cancel-behavior="icon">
    <div slot="body">
      <oj-select-single
        label-hint="Account Number"
        data="[[accountsDataProvider]]"
        value="{{newAccountNo}}"
        item-text="accountNo"
        item-value="accountNo"
        required>
      </oj-select-single>

      <oj-select-single
        label-hint="Card Type"
        data="[[cardTypesProvider]]"
        value="{{newCardType}}"
        item-text="label"
        item-value="value"
        required>
      </oj-select-single>

      <oj-input-date-time
        label-hint="Expiry Date"
        value="{{newExpiryDate}}"
        required>
      </oj-input-date-time>

      <oj-select-single
        label-hint="Status"
        data="[[statusesProvider]]"
        value="{{newStatus}}"
        item-text="label"
        item-value="value"
        required>
      </oj-select-single>

      <oj-input-text
        label-hint="CVV"
        value="{{newCvv}}"
        required>
      </oj-input-text>
    </div>

    <div slot="footer">
      <oj-button on-oj-action="[[addCard]]" class="oj-button-primary">Save</oj-button>
      <oj-button on-oj-action="[[cancelDialog]]">Cancel</oj-button>
    </div>
  </oj-dialog>
</div>
